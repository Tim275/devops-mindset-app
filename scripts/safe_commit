# scripts/safe_commit
#!/bin/bash
echo "ğŸ”„ Safe commit workflow..."

# Check versions
MANIFEST_VERSION=$(cat .release-please-manifest.json | grep frontend | cut -d'"' -f4)
PYPROJECT_VERSION=$(cat src/frontend/pyproject.toml | grep "version = " | cut -d'"' -f2)

echo "ğŸ“Š Manifest version: $MANIFEST_VERSION"
echo "ğŸ“Š Pyproject version: $PYPROJECT_VERSION"

if [ "$MANIFEST_VERSION" != "$PYPROJECT_VERSION" ]; then
    echo "âš ï¸  Versions don't match! Please fix manually."
    exit 1
fi

# Update lock file
echo "ğŸ”’ Updating lock file..."
cd src/frontend && uv lock && cd ../..

# Commit
echo "âœ… Ready to commit!"
git add .
cz commit